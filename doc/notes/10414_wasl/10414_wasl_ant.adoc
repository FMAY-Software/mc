:sectnums:
---

This work is licensed under the Creative Commons CC0 License

---

= Analyze Options for ASL BridgePoint
xtUML Project Analysis Note

== Abstract

This note documents research into a migration of Shlaer-Mellor application
models from iUML into BridgePoint.  Options are explored and observations
recorded.

== Document References

. [[dr-1]] https://support.onefact.net/issues/10414[10414 Analyze Options for Migration]
. [[dr-2]] https://docs.google.com/document/d/1LQYNA7Zln1h8h8wbRNeZb0GukVMXLV89nSwg8SICeG4/edit[SRS - Software Requirements Specification for client Assessment]
. [[dr-3]] https://support.onefact.net/issues/8269[8269 - Raven Project Phase 1]
. [[dr-4]] http://www.ooatool.com/docs/ASL03.pdf[UML ASL Reference Guide]
. [[dr-5]] link:../8073_masl_parser/8277_serial_masl_spec.md[Serial MASL (SMASL) Specification]

== Background

Models built with iUML and having MASL activities (action language bodies)
can be migrated into BridgePoint using a tool chain built for project Raven
<<dr-3>>.  A similar process is desired for models built with iUML
and having ASL activities.

The native iUML action language, _ASL_ (_Action Specification Language_),
has a syntax in the public domain.  A language reference for it can be
found in <<dr-4>>.  ASL is fundamentally similar to _OAL_
(_Object Action Language_, the default action language of BridgePoint),
however it is a bit richer and supports instance identity more tightly
on the create statement.  There are other advantages and disadvantages
[<<_action_language_comparison>>].

iUML models can be represented in a form consumable by a software
architecture (model compiler) called _WACA_ (_Waterloo Auto Code
Generator and Architecture_).  This form shall be denoted _WASL_
(short for WACA-with-ASL).

The highlights of this assessment include:

- choice of action language
- challenge of transforming WASL to xtUML (for conversion/import)
- challenge of generating WASL from xtUML (export to model compiler)
- loss and regeneration of model graphical diagram information
- testing and validation of the integrity of the conversions

[[wasl-flow]]
image::waslflow.png[WASL-to-xtUML and xtUML-to-WASL Flows]
WASL-to-xtUML and xtUML-to-WASL Flows

== Requirements

Requirements for an Assessment of migration options are defined in a
Software Requirements Specification (SRS) document <<dr-2>>.
The requirements are repeated here with some refinement.

=== Action Language SWOT
Analyze the relative strengths, weaknesses, opportunities and threats of
ASL versus MASL versus OAL moving forward.

=== ASL Editor
Explore and size an ASL action language syntax highlighting editor.

=== WASL2MASL
Analyze the costs and benefits of building a tool to convert WASL to MASL.

=== WASL2xtUML
Understand the work required to convert models from iUML-ASL (WASL) into
xtUML to be edited within BridgePoint (model conversion and import).

==== Diagram Editing
Enumerate diagram editing issues anticipated as part of model conversion
and ongoing editing of Kennedy-Carter idiom models in BridgePoint.
Include graphics issues and known differences between dialects of xtUML.

=== xtUML2WASL
Determine a strategy for exporting xtUML into the existing model compiler
tool chain (model export).  Determine packaging for the extraction tool
as a BridgePoint plugin, standalone tool or both.

=== File Formats
Isolate the interface to the model compilation tool chain and document
file formats noting that example files are supplied by client.

=== Integrity
Define steps to ensure and validate the integrity of models through
conversion process.
==== Round Trip
Explore the use of "round trip testing" to automate the import and export
and comparison of results.

=== Decision Data
For each of the above requirements, consider the following:

(A3) Sizings::
Establish relative sizings for various components and design choices.

(A4) Open Sourcing:: [Removed from scope.]

(A5) Talent Pool::
Recommend the use of internal versus external talent and the community.

(A6) Prototypes::
Develop working prototypes and/or mock ups of workflows with screenshots leveraging supplied example files.

(A7) Training::
Recommend training in modeling and tooling or ad hoc consultation.

(A8) Configuration Management::
iUML provides change configuration inside the tool (versions of domains
and projects defined as a set of domains at a particular version).
Analysis shall propose a path to migrate a particular version of the
current application models and describe how configuration would be managed
after migration.

(A9) Model Compiler Migration::
Following UML tool migration, model compiler migration would be the
logical next step. Perform analysis and define a roadmap for this.

== Analysis

=== Action Language Comparison
There are at least four action language possibilities in a migration:
ASL, OAL, MASL and Alf.  Others may exist, but these explored can be
considered true candidates.

This analysis concludes that a migration to ASL is a best first step
even if a migration to MASL (next choice) is desired in the future.

[options="header"]
|===
| dialect | strengthes                 | weaknesses             | opportunities  | threats
| ASL     | no change to existing flow | lack of BP interpreter | grow community | lack of parser
|         | direct pass-thru to WACA   | not parsed (initially) | enhance BP     |
|         | smallest change to tooling |                        |                |
|         | familiar to existing team  |                        |                |
|         | lowest initial cost        |                        |                |
|         | first step in any case     |                        |                |
| OAL     | BridgePoint native default | conversion required    |                | behavior differences
|         | interpreted in Verifier    | learning curve         |                |
|         | large body of examples     | less rich syntax       |                |
|         | alternate model compilers  |                        |                |
| MASL    | richest syntax             | conversion required    |                | few users
|         | strongest typing           | learning curve         |                |
|         | local (UK) user community  |                        |                |
|         | proximity to Ada target    |                        |                |
| Alf     | standardized by OMG        | conversion required    | more standard  | distraction
|         |                            | gaps in the semantics  |                |
|         |                            | lack of BP interpreter |                |
|         |                            | overly rich syntax     |                |
|===

=== ASL Editor
An ASL text editor could be produced that makes the experience of editing
ASL activities pleasant and productive (in that order!).
There are multiple levels of sophistication to preparing such an editor.
Listed here are features of a syntax highlighting editor ordered from
relatively easy to more challenging to implement.

[options="header"]
|===
| feature                              | description                                        | parser   | ROM effort
| keyword highlighting                 | emobolden and/or colorize language key words       |          | 1 week
| automatic indentation                | Indent after `if`, `else`, `loop`, etc.            | required | 1 month
| name validation                      | Validate identifiers with model elements.          | required | 1 month
| context-sensitive content assistance | Auto-completion and selection lists.               | required | 2 months
| rename/refactoring                   | Update activities when model element names change. | required | 4 months
|===

Syntax highlighting is relatively simple within an Eclipse environment.
A set of keywords can be defined and associated with the text editor.
Through pattern matching, the text editor highlights any of the words
found in the keyword configuration file.

Automatic indentation is the first feature to require a parser generated
from a Backus-Naur form (BNF or EBNF) grammar of the language.  An Eclipse
extension exists to assist with this; this extension has been used in the
OAL editor.

Name validation links the textual action language with the structural
elements of the language such as classes, associations, events, etc.
When parsing the activities, the names used in the action language
can be validated against the containing xtUML model.  Syntax errors
can be highlighted right away with the need to invoke the back end
compiler tool chain.  Name validation can be done "real-time" while
typing or as an overall model parse batch process.

Context-sensitive assistance was recently added to OAL in BridgePoint
and was received with acclaim.  The user experience is enhanced, and the
productivity improvement is measurable.  The feature requires a parser
that dynamically links to structural elements in the model and provides
lists of candidates for the next lexeme in the action language statement.

Rename/refactoring updates action language when structural model elements
are renamed or deleted.  The feature proactively helps the user update
the actions affected by a particular model edit.  This is a complex feature
with subtleties that must be considered carefully.  Such rename/refactoring
is a feature of the MASL activity editor.

=== WASL2MASL
WASL is a textual representation of a model including both structural
and activity definitions.  WASL represents class, association, state,
and transition instances as well as action language activities.
Likewise, MASL can represent the fullness of the Shlaer-Mellor semantic
for an application model.  Both languages are derivatives of the same
methodology (and roughly the same metamodel).  There is a mapping of
structural elements, and ASL activity semantics are a subset of MASL
activity semantics.  Therefore, WASL can potentially be converted to MASL.

Options for converting WASL to MASL include manual and automatic
conversion.  Three approaches could be taken:

[options="header"]
|===
| conversion strategy                                               | ROM effort
| WASL to xtUML to MASL with manual conversion of ASL activities    | linear to quantify of ASL
| WASL to xtUML to MASL with automatic conversion of ASL activities | 3 months (post initial migration)
| full textual WASL to full textual MASL                            | 4 months
|===

The distinction of manual versus automatic conversion of activities
is interesting, because it is likely that WASL will be converted to
xtUML+ASL as a first step in the tooling migration process.  As such,
it will be true that WASL models will have already been converted into
xtUML+ASL by the time a MASL conversion is needed.  This leaves only
the activities to be converted.

Note this conversion is valuable only if MASL is selected as the action
language now or at some future date.  Otherwise, this conversion has limited
value (in the case of using a MASL-compatible model compiler) or no value
at all.

=== WASL2xtUML
Considering <<waca-flow>>, WASL2xtUML is the conversion and import flow.
It is the top stream starting with WASL and ending with xtUML-with-ASL
editable with the BridgePoint tool.

Prototyping has confirmed that a utility called `m2x` can be leveraged.
`m2x` stands for MASL-to-xtUML.  `m2x` was built as part of the Raven <<dr-3>>
project.  The first step in the flow is a conversion of the input to
"serial MASL" (SMASL) <<dr-5>> using a parser.  Even though WASL is not
the same as MASL, the parser in the flow can be replaced to do a similar
conversion on WASL.  A prototype parser has been written that (partially)
converts WASL to SMASL.  This allows `m2x` to be reused (with a few changes)
to populate the xtUML metamodel with instances representing the input model.

[options="header"]
|===
| conversion task                                                   | ROM effort
| convert Relationship and Event                                    | 1 month
| convert arbitrary WASL models with round trip integrity checking  | 4 months
|===

This work is required in the initial phase to accomplish automated
model conversion.

==== Diagram Editing
WASL contains no graphical diagram information.  The semantics of the
model are carried without placement, spacial or size data.  The present
understanding is that graphical information is effectively trapped within
the iUML tool.  Graphical information will need to be restored to diagrams
with a combination of automatic graphics reconciliation and manual
arrangement.

BridgePoint has the capability to perform graphics reconciliation
(generate graphics) on semantic model data.  However, the layout is
limited.  Graphical elements are positioned such that they are not
on top of each.  Normally they are lined up side by side across the
top of a diagram canvas.  The user is left to drag the elements
(classes, states, packages) around and straighten the connectors
(class associations and state transitions).

Two connector routing algorithms are supported in BridgePoint,
`Oblique` (default) and `Rectilinear`.  Oblique routing uses a direct
routing strategy including diagonal lines.  Rectilinear routing
employs right angles.  Consider experimenting with these approaches
as diagrams are rearranged.

No specific engineering is required in a model migration.  Diagram
editing and layout can be handled procedurally.

=== xtUML2WASL
Considering <<waca-flow>>, xtUML2WASL is the export flow.
It is the bottom stream starting with xtUML and ending with WASL (flat
ascii files) consumable by the WACA model compiler.

Prototyping has confirmed that a utility called `x2m` can be leveraged.
`x2m` stands for xtUML-to-MASL.  `x2m` was also built as part of the
Raven <<dr-3>> project.

[options="header"]
|===
| conversion task                                                   | ROM effort
| convert Relationship and Event                                    | 1 month
| convert arbitrary WASL models with round trip integrity checking  | 4 months
|===

This work is required in the initial phase to accomplish automated
model conversion.

Determine a strategy for exporting xtUML into the existing model compiler
tool chain (model export).  Determine packaging for the extraction tool
(see Slide A1.2 above) as either a BridgePoint plugin, standalone tool or both.

=== File Formats
Isolate the interface to the model compilation tool chain and document
file formats noting that example files are supplied by client.

=== Integrity
Define steps to ensure and validate the integrity of models through
conversion process.
==== Round Trip
Explore the use of "round trip testing" to automate the import and export
and comparison of results.

== Conclusions and Recommendations

As stated in <<_background>>, there are significant challenges to face.
However, this project has the advantage of following after project
Raven <<dr-3>> which shared many of the same requirements and produced
tooling that can be leveraged to a significant extent.

=== Action Language
We recommend that ASL be used as the action language for the immediate
future.  We recommend that MASL be considered after a successful migration
of existing models.

. Stay with ASL until the tool migration is complete.
. Consider MASL as a long term strategy.

=== ASL Editor
. Add only keyword highlighting in the first version of the ASL activity editor.
. Add indentation next.
. Plan for real-time name validation and context-sensitive assistance.
. Consider the cost/benefit of rename/refactoring.

=== WASL2MASL
. This will be valuable if a migration to MASL is decided upon.  It is of no
value otherwise.

=== WASL2xtUML
. This is core.  Perform this task in the first phase of development.

=== xtUML2WASL
. This is core.  Perform this task in the first phase of development.

=== WASL Round Trip
. In order to satisfy the need for high integrity in the conversion of
WASL to xtUML and xtUML to WASL, employ the round-trip strategy to achieve
a high degree of confidence in the conversion.  This also reduces risk of
wasted graphical editing effort on models that need to be reconverted.

- challenge of transforming WACA to xtUML (for conversion/import)
- challenge of generating WACA from xtUML (export to model compiler)
- testing and validation of the integrity of the conversions
=== Diagram Editing
. Be certain model conversion is sound before performing manual diagram
rearrangement.
. Consider rearranging diagram layouts as needed.  There may be little
reason to lay out a diagram that is not being viewed on a regular basis.
. Employ `Oblique` and `Rectilinear` routing strategies during layout.

== End
